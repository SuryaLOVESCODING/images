"use strict";function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ACE=ACE||{};!function($){ACE.RegisterPlugin=function(name,object){$.fn[name]=function(options){var initialArgs=arguments;return this.each(function(i,e){var instance=$.data(this,name);if(instance){if("string"==typeof options){var args=Array.prototype.slice.call(initialArgs,1);$.isFunction(instance[options])&&instance[options].apply(instance,args)}}else $.data(this,name,new object(this,options))})}}}(jQuery);var ACE=ACE||{};ACE.Btn=ACE.Btn||{},ACE.Btn.LoadingWrap=function(){function LoadingWrap(element,options){_classCallCheck(this,LoadingWrap),this.element=$(element),this.options=this._generateOptions(options),this.toggled=!1,this.loadingWrapper}return _createClass(LoadingWrap,[{key:"_generateOptions",value:function(options){return $.extend(!0,{},LoadingWrap._getDefaultOptions(),options)}},{key:"toggle",value:function(bShowLoading){this.toggled=bShowLoading,bShowLoading?(this.toggleElement.hide(),this.loadingWrapper.show()):(this.toggleElement.show(),this.loadingWrapper.hide())}},{key:"toggleElement",get:function(){return this._toggleElement instanceof jQuery||(this._toggleElement=function(ctl){var toggleElementSelector=ctl.options.loadingControlOptions.toggleElementSelector;return $.isFunction(toggleElementSelector)?toggleElementSelector.call(ctl):null!==toggleElementSelector?ctl.element.find(toggleElementSelector):ctl.element}(this)),this._toggleElement}},{key:"loadingWrapper",get:function(){if(!(this._loadingWrapper instanceof jQuery)){var wrapClass=this.options.loadingControlOptions.wrapperClass+(this.options.loadingControlOptions.inheritToggledElementClass?" "+this.toggleElement.prop("class"):""),wrapper=$("<div />",{class:wrapClass,style:"display:none;"});$("<img />",{class:this.options.loadingControlOptions.animationClass,src:this.options.loadingControlOptions.animatedImage}).appendTo($("<"+this.options.loadingControlOptions.loadingTextTag+" />",{html:this.options.loadingControlOptions.loadingText}).appendTo(wrapper)),this._loadingWrapper=wrapper,this._loadingWrapper.insertAfter(this.toggleElement)}return this._loadingWrapper}}],[{key:"_getDefaultOptions",value:function(){return{loadingControlOptions:{wrapperClass:"LoadingWrap",animationClass:"LoadingAnimation",animatedImage:"/images/ajax-loader.gif",loadingTextTag:"h3",loadingText:"Please wait... &nbsp;&nbsp;",inheritToggledElementClass:!1,toggleElementSelector:null}}}}]),LoadingWrap}();var ACE=ACE||{};ACE.Btn=ACE.Btn||{},ACE.Btn.ButtonLoading=function(_ACE$Btn$LoadingWrap){function ButtonLoading(element,options){_classCallCheck(this,ButtonLoading);var _this=_possibleConstructorReturn(this,(ButtonLoading.__proto__||Object.getPrototypeOf(ButtonLoading)).call(this,element,options));return _this._bindClickEvent(),_this}return _inherits(ButtonLoading,_ACE$Btn$LoadingWrap),_createClass(ButtonLoading,[{key:"_generateOptions",value:function(options){return _get(ButtonLoading.prototype.__proto__||Object.getPrototypeOf(ButtonLoading.prototype),"_generateOptions",this).call(this,$.extend(!0,{},ButtonLoading._getDefaultOptions(),options))}},{key:"_trigger",value:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=("acebuttonloading"===type?type:"acebuttonloading"+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&!1===callback.apply(this.element[0],[event].concat(data))||event.isDefaultPrevented())}},{key:"_bindClickEvent",value:function(){var ctl=this;this.element.click(function(event,data){return ctl.toggled?(event.preventDefault(),!1):(ctl.toggle(!0),ctl._trigger("click",event,ctl)||ctl.toggle(!1),!ctl.options.preventDefaultClick&&void 0)})}}],[{key:"_getDefaultOptions",value:function(){return{preventDefaultClick:!1}}}]),ButtonLoading}(ACE.Btn.LoadingWrap);var ACE=ACE||{};ACE.Btn=ACE.Btn||{},ACE.Btn.AjaxButtonLoading=function(_ACE$Btn$ButtonLoadin){function AjaxButtonLoading(element,options){return _classCallCheck(this,AjaxButtonLoading),_possibleConstructorReturn(this,(AjaxButtonLoading.__proto__||Object.getPrototypeOf(AjaxButtonLoading)).call(this,element,options))}return _inherits(AjaxButtonLoading,_ACE$Btn$ButtonLoadin),_createClass(AjaxButtonLoading,[{key:"_generateOptions",value:function(options){var optionsToPass=$.extend(!0,{},AjaxButtonLoading._getDefaultAjaxButtonLoadingOptions(),options,{originalClickHandler:options?options.click:null,click:AjaxButtonLoading._buttonClicked});return _get(AjaxButtonLoading.prototype.__proto__||Object.getPrototypeOf(AjaxButtonLoading.prototype),"_generateOptions",this).call(this,optionsToPass)}},{key:"_handleUnathorizedHeader",value:function(xhr,status){return!AjaxButtonLoading._isUnauthorizedResult(xhr,status)||this._triggerUnauthorized(xhr,status)}},{key:"_triggerFn",value:function(type){var ctl=this,callback=ctl.options[type];return!$.isFunction(callback)||callback.apply(ctl,Array.prototype.slice.call(arguments,1))}},{key:"_getOptionResult",value:function(type){var ctl=this,option=ctl.options[type];return $.isFunction(option)?option.apply(ctl,Array.prototype.slice.call(arguments,1)):option}},{key:"_getSubmitData",value:function(){return this._getOptionResult("submitData")}},{key:"_getSubmitURL",value:function(){return this._getOptionResult("submitURL")}},{key:"_triggerSuccess",value:function(response,status,xhr){return this._triggerFn("onSuccess",response,status,xhr)}},{key:"_triggerOriginalSuccess",value:function(response,status,xhr){return this._triggerFn("originalSuccessHandler",response,status,xhr)}},{key:"_triggerOnComplete",value:function(xhr,status){return this._triggerFn("onComplete",xhr,status)}},{key:"_triggerError",value:function(xhr,status,error){return this._triggerFn("onError",xhr,status,error)}},{key:"_triggerOriginalError",value:function(xhr,status,error){return this._triggerFn("originalErrorHandler",xhr,status,error)}},{key:"_triggerUnauthorized",value:function(xhr,status){return this._triggerFn("onUnauthorized",xhr,status)}},{key:"_triggerBeginBtnClick",value:function(){return this._triggerFn("onBeginningBtnClicked")}}],[{key:"_getOptionalAjaxParams",value:function(ctrl){var ajaxOptions={};return ctrl.options.contentType&&(ajaxOptions.contentType=ctrl.options.contentType),ctrl.options.dataType&&(ajaxOptions.dataType=ctrl.options.dataType),ctrl.options.statusCode&&(ajaxOptions.statusCode=ctrl.options.statusCode),ajaxOptions}},{key:"_getDefaultAjaxButtonLoadingOptions",value:function(){return{submitURL:"",submitData:null,preventDefaultClick:!0,preventDataSerialization:!1,submitType:"",onSuccess:null,onError:null,onUnauthorized:null,onComplete:null}}},{key:"_buttonClicked",value:function(event,ctrl){if(!ctrl._trigger("originalClickHandler",null,ctrl))return!1;if(!ctrl._triggerBeginBtnClick())return!1;var url,strData,antiForgeryToken;try{url=ctrl._getSubmitURL();var submitData=ctrl._getSubmitData()||{};strData=ctrl.options.preventDataSerialization?submitData:JSON.stringify(submitData),antiForgeryToken=submitData.__RequestVerificationToken||""}catch(e){return console.log(e),!1}return $.ajax($.extend(!0,{type:ctrl._getOptionResult("submitType"),url:url,data:strData,success:function(data,status,xhr){if(ctrl.toggle(!1),!ctrl._handleUnathorizedHeader(xhr,status))return!1;ctrl._triggerSuccess(data,status,xhr)},error:function(xhr,status,_error){if(void 0!==this.statusCode&&"undefined"!=this.statusCode[xhr.status])return!1;ctrl.toggle(!1),ctrl._triggerError(xhr,status,_error)},complete:function(xhr,status){ctrl._triggerOnComplete(xhr,status)},headers:{__RequestVerificationToken:antiForgeryToken}},AjaxButtonLoading._getOptionalAjaxParams(ctrl))),!0}},{key:"_isUnauthorizedResult",value:function(xhr,status){var header=xhr.getResponseHeader("X-Responded-JSON");return null!==header&&"401"===JSON.parse(header).status}}]),AjaxButtonLoading}(ACE.Btn.ButtonLoading);var ACE=ACE||{};ACE.Btn=ACE.Btn||{},ACE.Btn.AddToCart=function(_ACE$Btn$AjaxButtonLo){function AddToCart(element,options){return _classCallCheck(this,AddToCart),_possibleConstructorReturn(this,(AddToCart.__proto__||Object.getPrototypeOf(AddToCart)).call(this,element,options))}return _inherits(AddToCart,_ACE$Btn$AjaxButtonLo),_createClass(AddToCart,[{key:"_generateOptions",value:function(options){var ctl=this,optionsToPass=$.extend(!0,{},this._getDefaultCartOptions(),options,{originalSuccessHandler:options?options.onSuccess:null,onSuccess:function(response,status,xhr){if(response.Successful){var addedSKUString="";ACE.TagManager.ItemAddedToCart(response),$.each(response.AddedItems,function(index,value){addedSKUString.length>0&&(addedSKUString+=","),addedSKUString+=value.SKU});var sCartURL=response.ShoppingCartURL+"?ACEProdSkus="+addedSKUString;ctl._triggerOriginalSuccess(response,sCartURL)&&(window.location.href=sCartURL)}else ctl._triggerOnAddToCartFailure(response,status,xhr)&&response.RedirectOnErrorURL&&(window.location=response.RedirectOnErrorURL)}});return _get(AddToCart.prototype.__proto__||Object.getPrototypeOf(AddToCart.prototype),"_generateOptions",this).call(this,optionsToPass)}},{key:"_triggerOnAddToCartFailure",value:function(response,status,xhr){return this._triggerFn("onAddToCartFailure",response,status,xhr)}},{key:"_getDefaultCartOptions",value:function(){var ctl=this;return{submitURL:"/api/cart",submitData:function(){return{SKU:ctl.element.data("sku")}},submitType:"PUT",contentType:"application/json; charset=utf-8",dataType:"json"}}}]),AddToCart}(ACE.Btn.AjaxButtonLoading),function($){ACE.RegisterPlugin("LoadingWrap",ACE.Btn.LoadingWrap),ACE.RegisterPlugin("ButtonLoading",ACE.Btn.ButtonLoading),ACE.RegisterPlugin("AjaxButtonLoading",ACE.Btn.AjaxButtonLoading),ACE.RegisterPlugin("AddToCart",ACE.Btn.AddToCart),$(".ACEAddToCart").filter("[data-sku]").AddToCart()}(jQuery);
//# sourceMappingURL=maps/ace.buttons.js.map
